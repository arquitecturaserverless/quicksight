<!DOCTYPE html>
<html>

    <head>
        <title>Dashboard Embedding Example</title>
        <script src="https://unpkg.com/amazon-quicksight-embedding-sdk@2.0.0/dist/quicksight-embedding-js-sdk.min.js"></script>
        <script type="text/javascript">
            const embedDashboard = async() => {
                const {
                    createEmbeddingContext,
                } = QuickSightEmbedding;

                const embeddingContext = await createEmbeddingContext({
                    onChange: (changeEvent, metadata) => {
                        console.log('Context received a change', changeEvent, metadata);
                    },
                });

                const frameOptions = {
                    url: "https://us-west-2.quicksight.aws.amazon.com/embed/2eaced0c02bb443e8d3973750939562e/dashboards/gfg-Dashboard-Id-Presentacion-BAM-Workflow?code=AYABeNcWO1-YLhHcJY4tOryk-xIAAAABAAdhd3Mta21zAEthcm46YXdzOmttczp1cy13ZXN0LTI6OTAwNjQ5NDI3MTk2OmtleS9iYzAzMTYzMy0xYzJiLTRlMzEtYWM5ZC0yODQ2NDkwZjEyM2YAuAECAQB4GTrtGnufGqRpvDXN80qWQP5C5v67xRWfqbMppBQ52E8BVwy6CxZtScOuxJvMd9MpvgAAAH4wfAYJKoZIhvcNAQcGoG8wbQIBADBoBgkqhkiG9w0BBwEwHgYJYIZIAWUDBAEuMBEEDFq-wL-jQaWSsGYttAIBEIA75np6zcVZO0SkbaIjc1VPPRteNnQ7Oc5I6veWKrzY9v_UZ6iDqNn4wuLpTOF0l-MBOdlSRiBtiAWhKc0CAAAAAAwAABAAAAAAAAAAAAAAAAAAMlvmtbUqHqpsYMlC7nmmDP____8AAAABAAAAAAAAAAAAAAABAAAAm_Fuu09xyxEgfhf36-3LAVhqnWyNXRTlExtVdAjFbHhIQb5nmRJrcN0Av6mCbeuw47SaBPpqI-sEXSNLLy9XiLmdZldgUlnFXZ1CsJZ1JIQEy8sAsjSMmBnA0xJcpYg3siyH9gZ1r3yLvQ5KS2pWfR4bo3DR5Dt7UD3AReOLJoXiVRVuYj2AFFrgue32sYwr8ktxWlSBNNdMBaSn1ohe8B72YGq2xXEwbcMdIg%3D%3D&identityprovider=quicksight&isauthcode=true",
                    container: '#experience-container',
                    height: "700px",
                    width: "1000px",
                    onChange: (changeEvent, metadata) => {
                        switch (changeEvent.eventName) {
                            case 'FRAME_MOUNTED': {
                                console.log("Do something when the experience frame is mounted.");
                                break;
                            }
                            case 'FRAME_LOADED': {
                                console.log("Do something when the experience frame is loaded.");
                                break;
                            }
                        }
                    },
                };

                const contentOptions = {
                    parameters: [
                        {
                            Name: 'country',
                            Values: [
                                'Colombia'
                            ],
                        },
                        {
                            Name: 'states',
                            Values: [
                                'California',
                                'Washington'
                            ]
                        }
                    ],
                    locale: "en-US",
                    sheetOptions: {
                        initialSheetId: 'gfg-Analisis-Id-Presentacion-BAM-Workflow',
                        singleSheet: false,                        
                        emitSizeChangedEventOnSheetChange: false,
                    },
                    toolbarOptions: {
                        export: false,
                        undoRedo: false,
                        reset: false
                    },
                    attributionOptions: {
                        overlayContent: false,
                    },
                    onMessage: async (messageEvent, experienceMetadata) => {
                        switch (messageEvent.eventName) {
                            case 'CONTENT_LOADED': {
                                console.log("All visuals are loaded. The title of the document:", messageEvent.message.title);
                                break;
                            }
                            case 'ERROR_OCCURRED': {
                                console.log("Error occurred while rendering the experience. Error code:", messageEvent.message.errorCode);
                                break;
                            }
                            case 'PARAMETERS_CHANGED': {
                                console.log("Parameters changed. Changed parameters:", messageEvent.message.changedParameters);
                                break;
                            }
                            case 'SELECTED_SHEET_CHANGED': {
                                console.log("Selected sheet changed. Selected sheet:", messageEvent.message.selectedSheet);
                                break;
                            }
                            case 'SIZE_CHANGED': {
                                console.log("Size changed. New dimensions:", messageEvent.message);
                                break;
                            }
                            case 'MODAL_OPENED': {
                                window.scrollTo({
                                    top: 0 // iframe top position
                                });
                                break;
                            }
                        }
                    },
                };
                const embeddedDashboardExperience = await embeddingContext.embedDashboard(frameOptions, contentOptions);

                const selectCountryElement = document.getElementById('country');
                selectCountryElement.addEventListener('change', (event) => {
                    embeddedDashboardExperience.setParameters([
                        {
                            Name: 'country',
                            Values: event.target.value
                        }
                    ]);
                });
            };
        </script>
    </head>

    <body onload="embedDashboard()">
        <h1>Dashboard generado por URL embedida incrustada usando SDK</h1>
        <div id="experience-container"></div>

        <div> 
            <h1> Dashboard generado por URL embedida incrustada usando Iframe</h1>          
            <iframe
                width="960"
                height="720"
                src="https://us-west-2.quicksight.aws.amazon.com/embed/2eaced0c02bb443e8d3973750939562e/dashboards/gfg-Dashboard-Id-Presentacion-BAM-Workflow?code=AYABeNcWO1-YLhHcJY4tOryk-xIAAAABAAdhd3Mta21zAEthcm46YXdzOmttczp1cy13ZXN0LTI6OTAwNjQ5NDI3MTk2OmtleS9iYzAzMTYzMy0xYzJiLTRlMzEtYWM5ZC0yODQ2NDkwZjEyM2YAuAECAQB4GTrtGnufGqRpvDXN80qWQP5C5v67xRWfqbMppBQ52E8BVwy6CxZtScOuxJvMd9MpvgAAAH4wfAYJKoZIhvcNAQcGoG8wbQIBADBoBgkqhkiG9w0BBwEwHgYJYIZIAWUDBAEuMBEEDFq-wL-jQaWSsGYttAIBEIA75np6zcVZO0SkbaIjc1VPPRteNnQ7Oc5I6veWKrzY9v_UZ6iDqNn4wuLpTOF0l-MBOdlSRiBtiAWhKc0CAAAAAAwAABAAAAAAAAAAAAAAAAAAMlvmtbUqHqpsYMlC7nmmDP____8AAAABAAAAAAAAAAAAAAABAAAAm_Fuu09xyxEgfhf36-3LAVhqnWyNXRTlExtVdAjFbHhIQb5nmRJrcN0Av6mCbeuw47SaBPpqI-sEXSNLLy9XiLmdZldgUlnFXZ1CsJZ1JIQEy8sAsjSMmBnA0xJcpYg3siyH9gZ1r3yLvQ5KS2pWfR4bo3DR5Dt7UD3AReOLJoXiVRVuYj2AFFrgue32sYwr8ktxWlSBNNdMBaSn1ohe8B72YGq2xXEwbcMdIg%3D%3D&identityprovider=quicksight&isauthcode=true">                >
                <!-- src="https://us-west-2.quicksight.aws.amazon.com/sn/embed/share/accounts/681989517074/dashboards/gfg-Dashboard-Id-Presentacion-BAM-Workflow?directory_alias=cobis-poc-dev"> -->
            </iframe>
        </div>

        <h1>Dashboard generado copiando enlace desde la consola</h1>
        <div>            
            <iframe
                width="960"
                height="720"
                src="https://us-west-2.quicksight.aws.amazon.com/sn/embed/share/accounts/681989517074/dashboards/gfg-Dashboard-Id-Presentacion-BAM-Workflow?directory_alias=cobis-poc-dev">
            </iframe>
        </div>
    </body>

</html>